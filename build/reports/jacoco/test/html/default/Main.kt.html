<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Main.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Cinema-movies</a> &gt; <a href="index.source.html" class="el_package">default</a> &gt; <span class="el_source">Main.kt</span></div><h1>Main.kt</h1><pre class="source lang-java linenums">import controllers.MovieAPI
import models.Description
import models.Movie
import utils.ScannerInput.readNextChar
import utils.ScannerInput.readNextInt
import utils.ScannerInput.readNextLine
import kotlin.system.exitProcess

<span class="nc" id="L9">private val MovieAPI = MovieAPI()</span>

<span class="nc" id="L11">fun main() = runMenu()</span>

fun runMenu() {
    do {
<span class="nc bnc" id="L15" title="All 14 branches missed.">        when (val option = mainMenu()) {</span>
<span class="nc" id="L16">            1 -&gt; addMovie()</span>
<span class="nc" id="L17">            2 -&gt; listMovies()</span>
<span class="nc" id="L18">            3 -&gt; updateMovie()</span>
<span class="nc" id="L19">            4 -&gt; deleteMovie()</span>
<span class="nc" id="L20">            5 -&gt; archiveMovie()</span>
<span class="nc" id="L21">            6 -&gt; addDescriptionToMovie()</span>
<span class="nc" id="L22">            7 -&gt; updateDescriptionContentsInMovie()</span>
<span class="nc" id="L23">            8 -&gt; deleteAndescription()</span>
<span class="nc" id="L24">            9 -&gt; markdescriptionStatus()</span>
<span class="nc" id="L25">            10 -&gt; searchMovies()</span>
<span class="nc" id="L26">            15 -&gt; searchdescriptions()</span>
<span class="nc" id="L27">            16 -&gt; listToDoDescriptions()</span>
<span class="nc" id="L28">            0 -&gt; exitApp()</span>
<span class="nc" id="L29">            else -&gt; println(&quot;Invalid menu choice: $option&quot;)</span>
        }
<span class="nc" id="L31">    } while (true)</span>
}

<span class="nc" id="L34">fun mainMenu() = readNextInt(</span>
    &quot;&quot;&quot; 
         &gt; -----------------------------------------------------  
         &gt; |                  Movie KEEPER APP                  |
         &gt; -----------------------------------------------------  
         &gt; | Movie MENU                                         |
         &gt; |   1) Add a Movie                                   |
         &gt; |   2) List Movies                                   |
         &gt; |   3) Update a Movie                                |
         &gt; |   4) Delete a Movie                                |
         &gt; |   5) Archive a Movie                               |
         &gt; -----------------------------------------------------  
         &gt; | description MENU                                         | 
         &gt; |   6) Add description to a Movie                           |
         &gt; |   7) Update description contents on a Movie               |
         &gt; |   8) Delete description from a Movie                      |
         &gt; |   9) Mark description as complete/todo                   | 
         &gt; -----------------------------------------------------  
         &gt; | REPORT MENU FOR MovieS                             | 
         &gt; |   10) Search for all Movies (by Movie title)        |
         &gt; |   11) .....                                       |
         &gt; |   12) .....                                       |
         &gt; |   13) .....                                       |
         &gt; |   14) .....                                       |
         &gt; -----------------------------------------------------  
         &gt; | REPORT MENU FOR descriptionS                             |                                
         &gt; |   15) Search for all descriptions (by description description)  |
         &gt; |   16) List TODO descriptions                             |
         &gt; |   17) .....                                       |
         &gt; |   18) .....                                       |
         &gt; |   19) .....                                       |
         &gt; -----------------------------------------------------  
         &gt; |   0) Exit                                         |
         &gt; -----------------------------------------------------  
<span class="nc" id="L68">         &gt; ==&gt;&gt; &quot;&quot;&quot;.trimMargin(&quot;&gt;&quot;)</span>
<span class="nc" id="L69">)</span>

// ------------------------------------
// Movie MENU
// ------------------------------------
fun addMovie() {
<span class="nc" id="L75">    val MovieTitle = readNextLine(&quot;Enter a title for the Movie: &quot;)</span>
<span class="nc" id="L76">    val MoviePriority = readNextInt(&quot;Enter a priority (1-low, 2, 3, 4, 5-high): &quot;)</span>
<span class="nc" id="L77">    val MovieCategory = readNextLine(&quot;Enter a category for the Movie: &quot;)</span>
<span class="nc" id="L78">    val isAdded = MovieAPI.add(Movie(MovieTitle = MovieTitle, MoviePriority = MoviePriority, MovieCategory = MovieCategory))</span>

<span class="nc bnc" id="L80" title="All 2 branches missed.">    if (isAdded) {</span>
<span class="nc" id="L81">        println(&quot;Added Successfully&quot;)</span>
    } else {
<span class="nc" id="L83">        println(&quot;Add Failed&quot;)</span>
    }
<span class="nc" id="L85">}</span>

fun listMovies() {
<span class="nc bnc" id="L88" title="All 2 branches missed.">    if (MovieAPI.numberOfMovies() &gt; 0) {</span>
<span class="nc" id="L89">        val option = readNextInt(</span>
            &quot;&quot;&quot;
                  &gt; --------------------------------
                  &gt; |   1) View ALL Movies          |
                  &gt; |   2) View ACTIVE Movies       |
                  &gt; |   3) View ARCHIVED Movies     |
                  &gt; --------------------------------
<span class="nc" id="L96">         &gt; ==&gt;&gt; &quot;&quot;&quot;.trimMargin(&quot;&gt;&quot;)</span>
        )

<span class="nc bnc" id="L99" title="All 4 branches missed.">        when (option) {</span>
<span class="nc" id="L100">            1 -&gt; listAllMovies()</span>
<span class="nc" id="L101">            2 -&gt; listActiveMovies()</span>
<span class="nc" id="L102">            3 -&gt; listArchivedMovies()</span>
<span class="nc" id="L103">            else -&gt; println(&quot;Invalid option entered: $option&quot;)</span>
        }
    } else {
<span class="nc" id="L106">        println(&quot;Option Invalid - No Movies stored&quot;)</span>
    }
<span class="nc" id="L108">}</span>

<span class="nc" id="L110">fun listAllMovies() = println(MovieAPI.listAllMovies())</span>
<span class="nc" id="L111">fun listActiveMovies() = println(MovieAPI.listActiveMovies())</span>
<span class="nc" id="L112">fun listArchivedMovies() = println(MovieAPI.listArchivedMovies())</span>

fun updateMovie() {
<span class="nc" id="L115">    listMovies()</span>
<span class="nc bnc" id="L116" title="All 2 branches missed.">    if (MovieAPI.numberOfMovies() &gt; 0) {</span>
        // only ask the user to choose the Movie if Movies exist
<span class="nc" id="L118">        val id = readNextInt(&quot;Enter the id of the Movie to update: &quot;)</span>
<span class="nc bnc" id="L119" title="All 2 branches missed.">        if (MovieAPI.findMovie(id) != null) {</span>
<span class="nc" id="L120">            val MovieTitle = readNextLine(&quot;Enter a title for the Movie: &quot;)</span>
<span class="nc" id="L121">            val MoviePriority = readNextInt(&quot;Enter a priority (1-low, 2, 3, 4, 5-high): &quot;)</span>
<span class="nc" id="L122">            val MovieCategory = readNextLine(&quot;Enter a category for the Movie: &quot;)</span>

            // pass the index of the Movie and the new Movie details to MovieAPI for updating and check for success.
<span class="nc bnc" id="L125" title="All 2 branches missed.">            if (MovieAPI.update(id, Movie(0, MovieTitle, MoviePriority, MovieCategory, false))) {</span>
<span class="nc" id="L126">                println(&quot;Update Successful&quot;)</span>
            } else {
<span class="nc" id="L128">                println(&quot;Update Failed&quot;)</span>
            }
        } else {
<span class="nc" id="L131">            println(&quot;There are no Movies for this index number&quot;)</span>
        }
    }
<span class="nc" id="L134">}</span>

fun deleteMovie() {
<span class="nc" id="L137">    listMovies()</span>
<span class="nc bnc" id="L138" title="All 2 branches missed.">    if (MovieAPI.numberOfMovies() &gt; 0) {</span>
        // only ask the user to choose the Movie to delete if Movies exist
<span class="nc" id="L140">        val id = readNextInt(&quot;Enter the id of the Movie to delete: &quot;)</span>
        // pass the index of the Movie to MovieAPI for deleting and check for success.
<span class="nc" id="L142">        val MovieToDelete = MovieAPI.delete(id)</span>
<span class="nc bnc" id="L143" title="All 2 branches missed.">        if (MovieToDelete) {</span>
<span class="nc" id="L144">            println(&quot;Delete Successful!&quot;)</span>
        } else {
<span class="nc" id="L146">            println(&quot;Delete NOT Successful&quot;)</span>
        }
    }
<span class="nc" id="L149">}</span>

fun archiveMovie() {
<span class="nc" id="L152">    listActiveMovies()</span>
<span class="nc bnc" id="L153" title="All 2 branches missed.">    if (MovieAPI.numberOfActiveMovies() &gt; 0) {</span>
        // only ask the user to choose the Movie to archive if active Movies exist
<span class="nc" id="L155">        val id = readNextInt(&quot;Enter the id of the Movie to archive: &quot;)</span>
        // pass the index of the Movie to MovieAPI for archiving and check for success.
<span class="nc bnc" id="L157" title="All 2 branches missed.">        if (MovieAPI.archiveMovie(id)) {</span>
<span class="nc" id="L158">            println(&quot;Archive Successful!&quot;)</span>
        } else {
<span class="nc" id="L160">            println(&quot;Archive NOT Successful&quot;)</span>
        }
    }
<span class="nc" id="L163">}</span>

// -------------------------------------------
// description MENU (only available for active Movies)
// -------------------------------------------

// TODO

// ------------------------------------
// Movie REPORTS MENU
// ------------------------------------
fun searchMovies() {
<span class="nc" id="L175">    val searchTitle = readNextLine(&quot;Enter the description to search by: &quot;)</span>
<span class="nc" id="L176">    val searchResults = MovieAPI.searchMoviesByTitle(searchTitle)</span>
<span class="nc bnc" id="L177" title="All 4 branches missed.">    if (searchResults.isEmpty()) {</span>
<span class="nc" id="L178">        println(&quot;No Movies found&quot;)</span>
    } else {
<span class="nc" id="L180">        println(searchResults)</span>
    }
<span class="nc" id="L182">}</span>

// ------------------------------------
// description REPORTS MENU
// ------------------------------------

// TODO

// ------------------------------------
// Exit App
// ------------------------------------
fun exitApp() {
<span class="nc" id="L194">    println(&quot;Exiting...bye&quot;)</span>
<span class="nc" id="L195">    exitProcess(0)</span>
}

// ------------------------------------
// HELPER FUNCTIONS
// ------------------------------------

private fun askUserToChooseActiveMovie(): Movie? {
<span class="nc" id="L203">    listActiveMovies()</span>
<span class="nc bnc" id="L204" title="All 2 branches missed.">    if (MovieAPI.numberOfActiveMovies() &gt; 0) {</span>
<span class="nc" id="L205">        val Movie = MovieAPI.findMovie(readNextInt(&quot;\nEnter the id of the Movie: &quot;))</span>
<span class="nc bnc" id="L206" title="All 2 branches missed.">        if (Movie != null) {</span>
<span class="nc bnc" id="L207" title="All 2 branches missed.">            if (Movie.isMovieArchived) {</span>
<span class="nc" id="L208">                println(&quot;Movie is NOT Active, it is Archived&quot;)</span>
            } else {
<span class="nc" id="L210">                return Movie // chosen Movie is active</span>
            }
        } else {
<span class="nc" id="L213">            println(&quot;Movie id is not valid&quot;)</span>
        }
    }
<span class="nc" id="L216">    return null // selected Movie is not active</span>
}

private fun addDescriptionToMovie() {
<span class="nc" id="L220">    val Movie: Movie? = askUserToChooseActiveMovie()</span>
<span class="nc bnc" id="L221" title="All 2 branches missed.">    if (Movie != null) {</span>
<span class="nc bnc" id="L222" title="All 2 branches missed.">        if (Movie.addDescription(Description(descriptionContents = readNextLine(&quot;\t description Contents: &quot;))))</span>
<span class="nc" id="L223">            println(&quot;Add Successful!&quot;)</span>
<span class="nc" id="L224">        else println(&quot;Add NOT Successful&quot;)</span>
    }
<span class="nc" id="L226">}</span>

fun updateDescriptionContentsInMovie() {
<span class="nc" id="L229">    val Movie: Movie? = askUserToChooseActiveMovie()</span>
<span class="nc bnc" id="L230" title="All 2 branches missed.">    if (Movie != null) {</span>
<span class="nc" id="L231">        val description: Description? = askUserToChooseDescription(Movie)</span>
<span class="nc bnc" id="L232" title="All 2 branches missed.">        if (description != null) {</span>
<span class="nc" id="L233">            val newContents = readNextLine(&quot;Enter new contents: &quot;)</span>
<span class="nc bnc" id="L234" title="All 2 branches missed.">            if (Movie.update(description.descriptionId, Description(descriptionContents = newContents))) {</span>
<span class="nc" id="L235">                println(&quot;description contents updated&quot;)</span>
            } else {
<span class="nc" id="L237">                println(&quot;description contents NOT updated&quot;)</span>
            }
        } else {
<span class="nc" id="L240">            println(&quot;Invalid description Id&quot;)</span>
        }
    }
<span class="nc" id="L243">}</span>

private fun askUserToChooseDescription(Movie: Movie): Description? {
<span class="nc bnc" id="L246" title="All 2 branches missed.">    if (Movie.numberOfDescriptions() &gt; 0) {</span>
<span class="nc" id="L247">        print(Movie.listDescriptions())</span>
<span class="nc" id="L248">        return Movie.findOne(readNextInt(&quot;\nEnter the id of the description: &quot;))</span>
    } else {
<span class="nc" id="L250">        println(&quot;No descriptions for chosen Movie&quot;)</span>
<span class="nc" id="L251">        return null</span>
    }
}

fun deleteAndescription() {
<span class="nc" id="L256">    val Movie: Movie? = askUserToChooseActiveMovie()</span>
<span class="nc bnc" id="L257" title="All 2 branches missed.">    if (Movie != null) {</span>
<span class="nc" id="L258">        val description: Description? = askUserToChooseDescription(Movie)</span>
<span class="nc bnc" id="L259" title="All 2 branches missed.">        if (description != null) {</span>
<span class="nc" id="L260">            val isDeleted = Movie.delete(description.descriptionId)</span>
<span class="nc bnc" id="L261" title="All 2 branches missed.">            if (isDeleted) {</span>
<span class="nc" id="L262">                println(&quot;Delete Successful!&quot;)</span>
            } else {
<span class="nc" id="L264">                println(&quot;Delete NOT Successful&quot;)</span>
            }
        }
    }
<span class="nc" id="L268">}</span>

fun markdescriptionStatus() {
<span class="nc" id="L271">    val Movie: Movie? = askUserToChooseActiveMovie()</span>
<span class="nc bnc" id="L272" title="All 2 branches missed.">    if (Movie != null) {</span>
<span class="nc" id="L273">        val description: Description? = askUserToChooseDescription(Movie)</span>
<span class="nc bnc" id="L274" title="All 2 branches missed.">        if (description != null) {</span>
<span class="nc" id="L275">            var changeStatus = 'X'</span>
<span class="nc bnc" id="L276" title="All 2 branches missed.">            if (description.isDescriptionComplete) {</span>
<span class="nc" id="L277">                changeStatus = readNextChar(&quot;The description is currently complete...do you want to mark it as TODO?&quot;)</span>
<span class="nc bnc" id="L278" title="All 4 branches missed.">                if ((changeStatus == 'Y') || (changeStatus == 'y'))</span>
<span class="nc" id="L279">                    description.isDescriptionComplete = false</span>
            } else {
<span class="nc" id="L281">                changeStatus = readNextChar(&quot;The description is currently TODO...do you want to mark it as Complete?&quot;)</span>
<span class="nc bnc" id="L282" title="All 4 branches missed.">                if ((changeStatus == 'Y') || (changeStatus == 'y'))</span>
<span class="nc" id="L283">                    description.isDescriptionComplete = true</span>
            }
        }
    }
<span class="nc" id="L287">}</span>

fun searchdescriptions() {
<span class="nc" id="L290">    val searchContents = readNextLine(&quot;Enter the description contents to search by: &quot;)</span>
<span class="nc" id="L291">    val searchResults = MovieAPI.searchDescriptionByContents(searchContents)</span>
<span class="nc bnc" id="L292" title="All 4 branches missed.">    if (searchResults.isEmpty()) {</span>
<span class="nc" id="L293">        println(&quot;No descriptions found&quot;)</span>
    } else {
<span class="nc" id="L295">        println(searchResults)</span>
    }
<span class="nc" id="L297">}</span>

fun listToDoDescriptions() {
<span class="nc bnc" id="L300" title="All 2 branches missed.">    if (MovieAPI.numberOfToDoDescriptions() &gt; 0) {</span>
<span class="nc" id="L301">        println(&quot;Total TODO descriptions: ${MovieAPI.numberOfToDoDescriptions()}&quot;)</span>
    }
<span class="nc" id="L303">    println(MovieAPI.listToDoDescriptions())</span>
<span class="nc" id="L304">}</span>
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>